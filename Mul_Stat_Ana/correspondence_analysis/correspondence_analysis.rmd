多元统计分析R语言应用——对应分析
=================================

对应分析是在因子分析的基础上发展起来的，因子分析分为R型因子分析和Q型因子分析，分别对变量和样品做因子分析，对应分析是将R型分析和Q型分析统一起来，通过R型因子分析直接得到Q型因子分析的结果，同时把变量和样品反映到相同的坐标轴的一张图形上，以此说明变量与样品之间的对应关系。

对应分析是研究两组或两组以上变量之间关系的有效方法。分对析的对象是二维或多维的列联表，首先进行因素的独立性检验，一般用卡方检验来分析它们之间的关系。如果两个因素独立，则没有必要进行对应分析；如果两个因素不独立，则可以通过对应分析的方法考察各个水平之间的相关关系。

对应分析步骤：

1. 由数据矩阵X，计算规格化的概率矩阵
2. 计算过渡矩阵Z
3. 进行因子分析

卡方检验和对应分析的R语言函数：
```{text}
chisq.test(X) #卡方分析函数
X 为样本

corresp(X, nf = 1, ...) #对应分析函数，在MASS包中。
X 表示进行对应分析的数据矩阵
nf 表示计算因子的个数
```

### 例题

对我国农村居民家庭纯收入进行对应分析。（数据见d10.2.xls）


```{r warning = FALSE}
X = read.table("d10.2.txt", header = T) #读入数据
library(MASS) #导入相关包
chisq.test(X) #进行卡方分析
# 由卡方分析结果可知，两个因素不独立，可以进行因子分析。
(CA = corresp(X, nf = 2)) #计算行和列得分
biplot(CA); abline(v =0, h = 0, Ity =3) #作对应分析图
```

结果显示绝大部分省份都是家庭经营性收入，而北京和上海主要为工资性收入，几乎没有那个省份主要是财产性收入，也没有哪个省份主要是转移性收入。